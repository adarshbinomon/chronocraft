const x = {
  cart: {
    items: [
      {
        productId: {
          _id: "64eae59d9bc2754c18b6d8b6",
          productName: "Duomètre Quantième Lunaire",
          brandName: "JAEGER-LECOULTRE",
          category: "Mechanical Watches",
          description:
            "The Jaeger Le-Coultre Duomètre collection is one of the most understated giants falling under the Haute Horlogerie category of fine watch-making. For this collection, what is inside matters just as much if not more than what is outside. The Duomètre welcomes precision and efficiency by running on two separate watch mechanisms powered by two independent reserves. This is the unique ‘Dual-Wing’ calibre characteristic of the profile of Duomètre watches. Each mechanism has a 50-hour power reserve, one of which serves to fuel the revolutionary Duomètre Chronographe, handling the secondary functions such as the 60-second counter, minutes, and hours. For the intricate timekeepers, the Duomètre collection is also equipped with a calendar iteration. Called the Duomètre Quantième Lunaire, this timepiece offers various functions such as moon phase, date, and alarm.",
          regularPrice: 4780000,
          salePrice: 4580000,
          quantity: 100,
          isListed: true,
          image: [
            "1693164445201-jaeger-lecoultre-polaris-q9028471-large.webp",
            "1693164445635-jaeger-lecoultre-polaris-q9028471-multiple-2.webp",
            "1693164445637-jaeger-lecoultre-polaris-q9028471-multiple-1.webp",
          ],
          __v: 0,
        },
        quantity: 2,
        _id: "64f5d390e9a57581151fd58c",
      },
      {
        productId: {
          _id: "64eb66ff131e4c323c691382",
          productName: "Petite Seconde Horophile 39 mm",
          brandName: "LOUIS ERARD",
          category: "Automatic Watches",
          description:
            "At Baselworld 2011 Louis Erard marked its 80th anniversary by announcing their classically styled line of watches, the Excellence Collection. With this edition, Louis Erard has tried to give the wearer a sense of tradition and occasion as it marks 80 years of stellar and precise watch-making by the Swiss company.",
          regularPrice: 244000,
          salePrice: 200000,
          quantity: 100,
          isListed: true,
          image: [
            "1693164978644-louis-erard-excellence-34237aa01-bva31-large.webp",
            "1693164979083-louis-erard-excellence-34237aa01-bva31-multiple-3.webp",
            "1693164979083-louis-erard-excellence-34237aa01-bva31-multiple-1.webp",
          ],
          __v: 0,
        },
        quantity: 2,
        _id: "64f5d79085f2b340cb98281f",
      },
      {
        productId: {
          _id: "64eb8c7f0d59e35aa6e0fe12",
          productName: "Laureato Chronograph 42 mm",
          brandName: "GIRARD-PERREGAUX",
          category: "Mechanical Watches",
          description:
            "Back when the disco era was at its peak and the fashion was all about bright colours and bell-bottoms, the Swiss watchmaking industry was going through a tough phase called the ‘Quartz Crisis’. The quartz crisis was the era when mechanical watches were being overwhelmed with battery-powered watches. Among the Swiss watchmakers, Girard-Perregaux was the first one to incorporate quartz movements. The Girard-Perregaux Laureato collection was released in 1975 and became the first Swiss watchmaker to incorporate quartz movements. After releasing different iterations of the Laureato, the collection was given a break. The Laureato was reintroduced in 2016 and has served the brand’s ‘Athleisure’ side since then.",
          regularPrice: 1970000,
          salePrice: 1799999,
          quantity: 150,
          isListed: true,
          image: [
            "1693164701132-girard-perregaux-laureato-81020-11-131-11a-large.webp",
            "1693164701132-girard-perregaux-laureato-81020-11-131-11a-multiple-2_4.webp",
            "1693164701135-girard-perregaux-laureato-81020-11-131-11a-multiple-5_2.webp",
          ],
          __v: 0,
        },
        quantity: 1,
        _id: "64f6304cce3b1bc199c72b8b",
      },
      {
        productId: {
          _id: "64eb90140d59e35aa6e0fe22",
          productName: "Apple Watch Ultra",
          brandName: "Apple",
          category: "Smart Watches",
          description:
            "The Apple Watch Ultra is the most rugged and capable Apple Watch ever, designed for the demanding needs of endurance athletes, outdoor adventurers, and ocean explorers. It features a robust titanium case, precision dual-frequency GPS, up to 36 hours of battery life, and apps for scuba and free diving.",
          regularPrice: 89999,
          salePrice: 82999,
          quantity: 9,
          isListed: true,
          image: [
            "1693159443861-Titanium-Case-with-Midnight-Ocean-Band.png",
            "1693159444269-apple-watch-ultra-gps-cellular-49-mm-retina-oled-display-orange-alpine-loop-original-smart-watch.jpeg",
          ],
          __v: 0,
        },
        quantity: 4,
        _id: "64f632f719a2a5a17aa04a48",
      },
      {
        productId: {
          _id: "64f488096f07f5feabbe6621",
          productName: "test",
          brandName: "asdadsfg",
          category: "Mechanical Watches",
          description: "sagradsdsf",
          regularPrice: 242,
          salePrice: 574567,
          quantity: 546,
          isListed: true,
          image: [
            "1693767331915-jaeger-lecoultre-duometre-q6042422-large.webp",
            "1693767332368-Titanium-Case-with-Midnight-Ocean-Band.png",
            "1693767332392-jaeger-lecoultre-polaris-q9028471-multiple-1.webp",
            "1693767332394-jaeger-lecoultre-polaris-q9028471-large.webp",
          ],
          __v: 0,
        },
        quantity: 3,
        _id: "64f6332a47297609f4413f87",
      },
      {
        productId: {
          _id: "64eb8df20d59e35aa6e0fe1e",
          productName: "Endurance Pro",
          brandName: "BREITLING",
          category: "Quartz Watches",
          description:
            "Breitling’s reputation for manufacturing instruments for professional aviators sees a culmination in the Breitling Professional collection. All watches from this line boast new-age technology coupled with sturdy constructions that make them ideal fits for the adventurous individual. Throughout the three series—Emergency, Aerospace Evo, Endurance, Breitling maintained their high standard crafting by providing watches that are not only accurate chronographs but also equipped with a multitude of features to meet the needs of all professionals.",
          regularPrice: 288100,
          salePrice: 199999,
          quantity: 66,
          isListed: true,
          image: [
            "1693164657852-breitling-professional-x82310d91b1s1-large.webp",
            "1693164657853-breitling-professional-x82310d91b1s1-multiple-1.webp",
            "1693164657857-breitling-professional-x82310d91b1s1-multiple-2.webp",
          ],
          __v: 0,
        },
        quantity: 1,
        _id: "64f639f2cfcec04c7e44455e",
      },
    ],
  },
  _id: "64e77dd91353658ffaa2d5d1",
  name: "Noel",
  email: "nkj2800@gmail.com",
  phoneNumber: "9400728381",
  password: "$2b$10$5WZnsCpIHh2U1ahxI/XpC..UHhpKUfJf5zqiN1A7NhLf9MrHTYWR2",
  isAdmin: 0,
  __v: 6,
  isActive: true,
};
function changeQuantity(productId,count,Subtotal,price){
    alert(price)
    // userCart.cart[i].productId.salePrice * userCart.cart[i].quantity
    document.getElementById("subTotal").innerHTML= Subtotal+(price*count); 


    <td><span class="badge rounded-pill alert-success">Received</span></td>
    <td><span class="badge rounded-pill alert-danger">Canceled</span></td>
    <td><span class="badge rounded-pill alert-warning">Pending</span></td>


    const postOrder = async (req, res) => {
      try {
        const userId = req.session.user_id;
        const userData = await User.findById(userId, { cart: 1, _id: 0 });
    
        const order = new Order({
          customerId: userId,
          products: userData.cart,
          quantity: req.body.quantity,
          price: req.body.salePrice,
          totalAmount: req.body.GrandTotal,
          paymentMethod: req.body.paymentMethod,
          shippingAddress: JSON.parse(req.body.address),
        });
        const orderSuccess = await order.save();
        if (orderSuccess) {
          for (const cartItem of userData.cart) {
            const product = await Product.findById(cartItem.productId);
    
            if (product) {
              product.stock -= cartItem.quantity;
              await product.save();
            }
          }
          await User.updateOne({ _id: userId }, { $unset: { cart: 1 } });
    
          if (req.body.paymentMethod === "COD") {
            console.log("razzzz2");
    
            res.redirect("/order-success");
            // console.log(req.body);
          } else if (req.body.paymentMethod === "razorpay") {
            console.log(req.body);
    
            const amount = req.body.GrandTotal * 100;
            const options = {
              amount: amount,
              currency: "INR",
              receipt: req.body.email,
            };
    
            razorpay.orders.create(options, (err, order) => {
              console.log(err, "oo");
              if (!err) {
                console.log("hai baby");
                res.status(200).send({
                  success: true,
                  msg: "Order created",
                  order_id: order.id,
                  amount: amount,
                  key_id: RAZORPAY_ID_KEY,
                  // productId : req.body.products.productId,
                  contact: "9998887776",
                  name: "admin",
                  email: "admin@gmail.com",
                });
              } else {
                console.log("jhkgsfdkjh");
                res
                  .status(400)
                  .send({ success: false, msg: "Something went wrong!" });
              }
            });
          }
        }
      } catch (error) {
        console.log(error.message);
      }
    };